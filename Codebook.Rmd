---
title: "Israeli Peripherality"
author: "Anna Weiner"
date: "`r Sys.Date()`"
output: 
  pdf_document:
    includes:
      in_header: header.tex
urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE, 
  eval = TRUE, 
  fig.align='center',
  message=FALSE, 
  warning=FALSE
)

knitr::knit_hooks$set(
  inline = function(x) {
    if(!is.numeric(x)){x}else{
      prettyNum(round(x, 2), big.mark = ',')
    }
  }
)
  
library(tidyverse)
library(knitr)
library(readxl)

load("/Users/annaweiner/Downloads/Programming/Final-Project/Israel_Peripherality_Data.RData")

cbfactor = function(.data, x){
    x = enquo(x)
    count(.data, !!x) |>
      mutate(
        values = as.numeric(!!x),
        labels = as_factor(!!x),
        freq = n,
        perc = n / sum(n) * 100,
        .keep = 'unused'
      ) |>
      knitr::kable(digits = 1L)
}

numfunction = function(.data, x){
    x = enquo(x)
    .data |>
     summarize(
      Min = min(!!x, na.rm = T),
      Mean = mean(!!x, na.rm = T),
      Median = median(!!x, na.rm = T),
      Max = max(!!x, na.rm = T),
      NAs = sum(is.na(!!x))
    ) |>
    knitr::kable(digits = 1L)   
}    
```

## Overview
This code book contains information on peripherality data from Israel in 2020. The 2020 values were compiled from two data sets in order to fill out missing variables. The data was procured from Israel's Central Bureau of Statistics (CBS) and was created by Natalia Tsibel on December 26, 2022. More information on data collection methods and the compilation process can be found by emailing the CBS at info@cbs.gov.il

A third data set from the CBS was added to reflect demographic information at the locality level. This dataset can be acquired [here](https://www.cbs.gov.il/he/publications/Pages/2017/%D7%90%D7%95%D7%9B%D7%9C%D7%95%D7%A1%D7%99%D7%99%D7%94-%D7%95%D7%9E%D7%A8%D7%9B%D7%99%D7%91%D7%99-%D7%92%D7%99%D7%93%D7%95%D7%9C-%D7%91%D7%99%D7%99%D7%A9%D7%95%D7%91%D7%99%D7%9D-%D7%95%D7%91%D7%90%D7%96%D7%95%D7%A8%D7%99%D7%9D-%D7%A1%D7%98%D7%98%D7%99%D7%A1%D7%98%D7%99%D7%99%D7%9D-2017.aspx). This data set was compiled in 2019.

A fourth data set from the CBS was added to reflect peripherality data from 2015. This allows for comparisons over time between the same localities, both in degree of peripherality and accessibility. This data set was compiled in 2019 and can be found [here](https://www.cbs.gov.il/he/publications/Pages/2019/%D7%9E%D7%93%D7%93-%D7%A4%D7%A8%D7%99%D7%A4%D7%A8%D7%99%D7%90%D7%9C%D7%99%D7%95%D7%AA-%D7%A9%D7%9C-%D7%99%D7%99%D7%A9%D7%95%D7%91%D7%99%D7%9D-%D7%95%D7%A9%D7%9C-%D7%A8%D7%A9%D7%95%D7%99%D7%95%D7%AA-%D7%9E%D7%A7%D7%95%D7%9E%D7%99%D7%95%D7%AA-2015.aspx). 

## Methodology
Demographic data is collected from Israel's localities annually, who report to the central government. The Central Bureau of Statistics then uses this data to compile various publicly available data sets.  

Accessibility and proximity values are based on data received from regional councils, then calculated as a mean value for each localities within the regional council and weighted by population size. 

Peripherality index values are calculated as the weighted sum of the standardized values of the potential accessibility index. 2/3 of the weight is the Accessibility Value, and 1/3 of the weight is proximity to the boundary of the Tel Aviv District. The peripherality index compares localities in terms of proximity to Israel's center and their proximity to opportunities and economic activity.

The population consists of Israeli citizens and permanent residents without Israeli citizenship. It includes persons listed in the Population Register only. 

All missing data is marked as "NA".

For a detailed English-language map of local authority clusters as referenced in the data, please see the map on the next page. The original image can be found [here](https://www.cbs.gov.il/he/pages/search/SearchResultsMain.aspx?k=peripherality#Default=%7B%22k%22%3A%22peripherality%22%2C%22s%22%3A11%2C%22l%22%3A1037%7D#8af72ebd-bbdb-4069-a27e-d6fc4b1c7b66=%7B%22k%22%3A%22peripherality%22%2C%22l%22%3A1037%7D#b4f5fa70-e25e-4e03-b36e-6dfca3f3ce8d=%7B%22k%22%3A%22peripherality%22%2C%22l%22%3A1037%7D).

```{r, fig.cap="Israel Peripherality Graphic, 2015"}
knitr::include_graphics("/Users/annaweiner/Downloads/Programming/Final-Project/Israel_map_peripherality.pdf")
```

## Code Book

Variable name: locality_code      
Variable type: numeric      
Description: Government-assigned code to each locality.    
```{r}
numfunction(codebook_clean, locality_code)
```

Variable name: local_authority      
Variable type: character       
Description: Name of local authority.

Variable name: locality       
Variable type: character         
Description: Name of locality.       

Variable name: centrality       
Variable type: factor        
Description: Ranks distance from Tel Aviv. "Central" refers to localities within 75 kilometers of Tel Aviv, "Suburban" refers to localities 75-150 kilometers from Tel Aviv, and "Peripheral" refers to localities over 150 kilometers from Tel Aviv.         
```{r}
cbfactor(codebook_clean, centrality)
```

Variable name: accessibility_2020_rank        
Variable type: numeric      
Description: A mean value for the year 2020 in each locality weighted by population size. Determined by accessibility to transportation infrastructure to Israel's center. These mean values are then ranked from 1 (least accessible) to 1213 (most accessible).       
```{r}
numfunction(codebook_clean, accessibility_2020_rank)
```

Variable name: peri_index_2020_rank       
Variable type: numeric      
Description: A mean value for each locality within each regional council and weighted by population size. Determines score on Israel's peripherality index for 2020. Rankings range from 1 (most peripheral) to 1213 (most central).     
```{r}
numfunction(codebook_clean, peri_index_2020_rank)
```

Variable name: accessibility_2015_rank       
Variable type: numeric        
Description: A mean value for the year 2015 in each locality weighted by population size. Determined by accessibility to transportation infrastructure to Israel's center. These mean values are then ranked from 1 (least accessible) to 1213 (most accessible).       
```{r}
numfunction(codebook_clean, accessibility_2015_rank)
```

Variable name: peri_index_2015_rank       
Variable type: numeric      
Description: A mean value for each locality within each regional council and weighted by population size. Determines score on Israel's peripherality index for 2015. Rankings range from 1 (most peripheral) to 1213 (most central).     
```{r}
numfunction(codebook_clean, peri_index_2015_rank)
```

Variable name: peri_change    
Variable type: character      
Description: Has three values: `less peripheral`, `more peripheral`, and `no change`. These values are calculated by seeing if there is, or is not, a change between peri_index_2015_rank and peri_index_2020_rank.    

Variable name: access_change   
Variable type: character             
Description: Has three values: `less accessible`, `more accessible`, and `no change`. These values are calculated by seeing if there is, or is not, a change between accessibility_2015_rank and accessibility_2020_rank.    

Variable name: improvement       
Variable type: factor       
Description: Ranks degree of improvement in the fields of accessibility and peripherality: "all" refers to improvements in both accessibility and peripherality; "significant" refers to increases in accessibility but a decrease or no change in periperality; "partial" refers to increases in centrality but a decrease or no change in accessibility; "regress" refers to decreases in both centrality and accessibility, or decreases in once category and no change in the other; and "none" refers to no change in either category               
```{r}
cbfactor(codebook_clean, improvement)
```

Variable name: population   
Variable type: numeric      
Description: Total population in each locality.   
```{r}
numfunction(codebook_clean, population)
```

Variable name: jews     
Variable type: numeric      
Description: Total Jewish population in each locality.   
```{r}
numfunction(codebook_clean, jews)
```

Variable name: arabs    
Variable type: numeric      
Description: Total Arab population in each locality. This category includes Muslims, Christians, Druze, and Circassians.   
```{r}
numfunction(codebook_clean, arabs)
```

Variable name: others   
Variable type: numeric      
Description: Total non-Jewish and non-Arab population in each locality.    
```{r}
numfunction(codebook_clean, others)
```

Variable name: majority   
Variable type: character         
Description: Has two values: `jewish` and `arab`. These values are calculated by comparing the Jewish or Arab population in each locality and concluding which is larger.    